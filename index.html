<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¨Ø§Ø²ÛŒ Ø­Ø§ÙØ¸Ù‡ Ù…ÛŒÙˆÙ‡ Ø§ÛŒ</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma}
body{
background:linear-gradient(135deg,#5f2c82,#49a09d);
min-height:100vh;color:white;padding:20px;overflow-x:hidden
}
.screen{display:none;max-width:600px;margin:0 auto}
.active{display:block}
.header{text-align:center;margin-bottom:30px;padding:20px}
h1{
font-size:2.5rem;margin-bottom:10px;
background:linear-gradient(45deg,#ff9a9e,#fad0c4);
-webkit-background-clip:text;-webkit-text-fill-color:transparent
}
.btn{
display:block;width:100%;max-width:300px;margin:15px auto;
padding:15px;border:none;border-radius:12px;
font-size:1.2rem;font-weight:bold;cursor:pointer
}
.btn-primary{background:linear-gradient(45deg,#ff9a9e,#fad0c4);color:white}
.btn-danger{background:linear-gradient(45deg,#ff6b6b,#ffa8a8);color:white}

.level-card{
background:rgba(255,255,255,.1);border-radius:15px;
padding:20px;margin:20px auto;max-width:300px;
text-align:center;cursor:pointer
}

.cards-container{
display:grid;gap:10px;justify-content:center;margin:30px 0
}

.card{
width:80px;height:80px;border-radius:12px;
cursor:pointer;position:relative;
transform-style:preserve-3d;
transition:transform .5s;font-size:2.5rem;
display:flex;align-items:center;justify-content:center
}

.easy .card{background:rgba(76,175,80,.3)}
.medium .card{background:rgba(255,152,0,.3)}
.hard .card{background:rgba(244,67,54,.3)}

.card.flipped{transform:rotateY(180deg)}
.card.matched{opacity:.5}

.card-front,.card-back{
position:absolute;width:100%;height:100%;
backface-visibility:hidden;border-radius:10px;
display:flex;align-items:center;justify-content:center
}
.card-front{background:#a1c4fd}
.card-back{background:#ff9a9e;transform:rotateY(180deg)}
</style>
</head>

<body>

<!-- Ù…Ù†Ùˆ -->
<div id="main-menu" class="screen active">
<div class="header">
<h1>Ø¨Ø§Ø²ÛŒ Ø­Ø§ÙØ¸Ù‡ Ù…ÛŒÙˆÙ‡ Ø§ÛŒ</h1>
<p>Ø­Ø§ÙØ¸Ù‡ Ø®ÙˆØ¯ Ø±Ø§ Ù…Ø­Ú© Ø¨Ø²Ù†ÛŒØ¯</p>
</div>
<button class="btn btn-primary" onclick="showScreen('level-select')">Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ</button>
</div>

<!-- Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø·Ø­ -->
<div id="level-select" class="screen">
<div class="header"><h1>Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø·Ø­</h1></div>

<div class="level-card" onclick="startGame('easy')">Ø¢Ø³Ø§Ù†</div>
<div class="level-card" onclick="startGame('medium')">Ù…ØªÙˆØ³Ø·</div>
<div class="level-card" onclick="startGame('hard')">Ø³Ø®Øª</div>

<button class="btn btn-danger" onclick="showScreen('main-menu')">Ø¨Ø§Ø²Ú¯Ø´Øª</button>
</div>

<!-- Ø¨Ø§Ø²ÛŒ -->
<div id="game-screen" class="screen">
<div class="header">
<h1 id="game-title"></h1>
</div>

<div id="cards-container" class="cards-container"></div>

<button class="btn btn-danger" onclick="showScreen('level-select')">Ø¨Ø§Ø²Ú¯Ø´Øª</button>
</div>

<!-- Ù†ØªÛŒØ¬Ù‡ -->
<div id="result-screen" class="screen">
<div class="header"><h1 id="result-message"></h1></div>
<button class="btn btn-primary" onclick="showScreen('level-select')">Ø¯ÙˆØ¨Ø§Ø±Ù‡</button>
<button class="btn" onclick="showScreen('main-menu')">Ù…Ù†Ùˆ</button>
</div>

<script>
/* ================= Ù…ØªØºÛŒØ±Ù‡Ø§ ================= */
let currentLevel,cards=[],flipped=[],matches=0,totalPairs=0,timeLeft,timer;
const levelConfig={
easy:{cards:12,time:60,cols:4},
medium:{cards:16,time:90,cols:4},
hard:{cards:20,time:120,cols:4}
};
const fruits=["ğŸ","ğŸŒ","ğŸ’","ğŸ“","ğŸŠ","ğŸ‡","ğŸ‰","ğŸ‘","ğŸˆ","ğŸ"];

/* ================= Ù†Ù…Ø§ÛŒØ´ ØµÙØ­Ù‡ + BACK ================= */
function showScreen(id,push=true){
document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
document.getElementById(id).classList.add("active");
if(push)history.pushState({screen:id},"",`#${id}`);
if(id==="game-screen")initGame();
}

window.addEventListener("popstate",e=>{
if(e.state&&e.state.screen){
showScreen(e.state.screen,false);
}else{
showScreen("main-menu",false);
}
});

history.replaceState({screen:"main-menu"},"","#main-menu");

/* ================= Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ ================= */
function startGame(level){
currentLevel=level;
showScreen("game-screen");
}

function initGame(){
clearInterval(timer);
matches=0;flipped=[];
const cfg=levelConfig[currentLevel];
totalPairs=cfg.cards/2;
timeLeft=cfg.time;

document.getElementById("game-title").innerText="Ø³Ø·Ø­ "+currentLevel;

const container=document.getElementById("cards-container");
container.innerHTML="";
container.className="cards-container "+currentLevel;
container.style.gridTemplateColumns=`repeat(${cfg.cols},1fr)`;

let values=[];
for(let i=0;i<totalPairs;i++){
values.push(fruits[i],fruits[i]);
}
values.sort(()=>Math.random()-.5);

values.forEach(v=>{
const card=document.createElement("div");
card.className="card";
card.dataset.val=v;
card.innerHTML=`<div class="card-front">?</div><div class="card-back">${v}</div>`;
card.onclick=()=>flipCard(card);
container.appendChild(card);
cards.push(card);
});

timer=setInterval(()=>{
timeLeft--;
if(timeLeft<=0)endGame(false);
},1000);
}

/* ================= Ù…Ù†Ø·Ù‚ Ú©Ø§Ø±Øª ================= */
function flipCard(card){
if(card.classList.contains("flipped")||flipped.length==2)return;
card.classList.add("flipped");
flipped.push(card);

if(flipped.length==2){
setTimeout(()=>{
if(flipped[0].dataset.val===flipped[1].dataset.val){
flipped.forEach(c=>c.classList.add("matched"));
matches++;
if(matches===totalPairs)endGame(true);
}else{
flipped.forEach(c=>c.classList.remove("flipped"));
}
flipped=[];
},700);
}
}

function endGame(win){
clearInterval(timer);
document.getElementById("result-message").innerText=
win?"ğŸ‰ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯ÛŒ!":"â° Ø²Ù…Ø§Ù† ØªÙ…ÙˆÙ… Ø´Ø¯";
showScreen("result-screen");
}
</script>

</body>
</html>
